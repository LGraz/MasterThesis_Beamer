%%%%%%%%%%%%%%%%%%%%%%
%% step plots --------
% 1_ndvi.pdf
% 2_itpl.pdf
% 3_itpl_rew.pdf
% 4_ndvi_scl.pdf
% 5_show_res.pdf
% 6_corr.pdf
% 7_uncert.pdf
% 8_corr_itpl_rew.pdf
%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[t]{1. Interpolation}
    \begin{columns}
        \begin{column}{0.45\textwidth}

        \end{column}
        \begin{column}{0.42\textwidth}
            \begin{figure}
                % \centering
                \vspace{-1.8cm}
                \includegraphics[width=\textwidth]{step_plot/2017-201_ndvi.pdf}
                \includegraphics[width=\textwidth]{step_plot/2017-202_itpl.pdf}
            \end{figure}
        \end{column}
    \end{columns}
    % \vfill\null
\end{frame}

% \begin{frame}[t]{2. Robust Reweighting}
%     \begin{columns}
%         \begin{column}{0.45\textwidth}
%             \begin{enumerate}
%                 \item initial curve
%                 \item give lower weight to outliers\\ (high residuals)
%                 \item re-fit curve
%             \end{enumerate}
%         \end{column}
%         \begin{column}{0.42\textwidth}
%             \begin{figure}
%                 % \centering
%                 \vspace{-1.8cm}
%                 \includegraphics[width=\textwidth]{step_plot/2017-202_itpl.pdf}
%                 \includegraphics[width=\textwidth]{step_plot/2017-203_itpl_rew.pdf}
%             \end{figure}
%         \end{column}
%     \end{columns}
%     % \vfill\null
% \end{frame}

\begin{frame}[t]{2. Other SCL-Classes}
    \begin{columns}
        \begin{column}{0.45\textwidth}
            \begin{table}[h]
            \vspace{-0.6cm}
                % \centering
                \tiny
                \begin{tblr}{
                    colspec = {p{0.1\linewidth} p{0.03\linewidth} p{0.5\linewidth}},
                %   row{2} = {SCL3color},
                %   column{3} = {teal7},
                cell{2}{1} = {SCL0color},
                  cell{3}{1} = {SCL1color},
                  cell{4}{1} = {SCL2color},
                  cell{5}{1} = {SCL3color},
                  cell{6}{1} = {SCL4color},
                  cell{7}{1} = {SCL5color},
                  cell{8}{1} = {SCL6color},
                  cell{9}{1} = {SCL7color},
                  cell{10}{1} = {SCL8color},
                  cell{11}{1} = {SCL9color},
                  cell{12}{1} = {SCL10color},
                  cell{13}{1} = {SCL11color},
                  }
                  % \toprule % not working :8
                  \hline
                Color & No. & Class \\
                \hline
                & 0: & Missing Data 	\\
                & 1: & Saturated or defective pixel 	\\
                & 2: & Dark features / Shadows 	\\
                & 3: & Cloud shadows 	\\
                & 4: & Vegetation 	\\
                & 5: & Bare soils 	\\
                & 6: &  Water\\	 
                & 7: &  Cloud low probability\\
                & 8: &  Cloud medium probability\\
                & 9: &  Cloud high probability\\
                & 10: &  Thin cirrus cloud\\
                & 11: &  Snow or ice\\
                  \hline
                %   \bottomrule
                \end{tblr}
              \end{table}
            % \begin{figure}
            %     % \centering
            %     \includegraphics[width=0.6\textwidth]{satelite/scl_classes_cpt.png}
            % \end{figure}
            % \textbf{SCL} = \textbf{S}cene \textbf{C}lassification \textbf{L}ayer
        \end{column}
        \begin{column}{0.42\textwidth}
            \begin{figure}
                % \centering
                \vspace{-1.8cm}
                \includegraphics[width=\textwidth]{step_plot/2017-203_itpl_rew.pdf}
                \includegraphics[width=\textwidth]{step_plot/2017-204_ndvi_scl.pdf}
            \end{figure}
        \end{column}
    \end{columns}
    % \vfill\null
\end{frame}

\begin{frame}[t]{3. Correction}
    \begin{columns}
        \begin{column}{0.45\textwidth}
            % \vspace{-1cm}
            % \includegraphics<1>[width=1.15\textwidth]{satelite/sentinel-2-bands.jpg}
            \begin{itemize}
                \item get `true' NDVI
                \item get table:
            \end{itemize}

            \small
            \begin{tabular}{| c |  c c c |}
                \hline
                \color{myred}{NDVI\textsuperscript{`true'}} & NDVI\textsuperscript{observed} & SCL & B2-B10 \\
                \color{myred}{NDVI\textsuperscript{`true'}} & NDVI\textsuperscript{observed} & SCL & B2-B10 \\
                \color{myred}{\dots    } & \dots    & \dots     & \dots  \\
                % \hline
            \end{tabular}\normalsize \vspace{0.5cm}
        \end{column}
        \begin{column}{0.42\textwidth}
            \begin{figure}
                % \centering
                \vspace{-1.8cm}
                \includegraphics<1>[width=\textwidth]{step_plot/2017-204_ndvi_scl.pdf}
                \includegraphics<1>[width=\textwidth]{step_plot/2017-205_show_res.pdf}
            \end{figure}
        \end{column}
    \end{columns}
    % \vfill\null
\end{frame}

\begin{frame}[t]{3. Correction}
    \begin{columns}
        \begin{column}{0.45\textwidth}
            % \vspace{-1cm}
            % \includegraphics<1>[width=1.15\textwidth]{satelite/sentinel-2-bands.jpg}
            \begin{itemize}
                \item get `true' NDVI
                \item get table:
            \end{itemize}

            \small
            \begin{tabular}{| c |  c c c |}
                \hline
                \color{myred}{NDVI\textsuperscript{`true'}} & NDVI\textsuperscript{observed} & SCL & B2-B10 \\
                \color{myred}{NDVI\textsuperscript{`true'}} & NDVI\textsuperscript{observed} & SCL & B2-B10 \\
                \color{myred}{\dots    } & \dots    & \dots     & \dots  \\
                % \hline
            \end{tabular}\normalsize \vspace{0.5cm}
            \begin{itemize}
                \item Statistical model
                \item predict/correct NDVI
            \end{itemize}
        \end{column}
        \begin{column}{0.42\textwidth}
            \begin{figure}
                % \centering
                \vspace{-1.8cm}
                \includegraphics[width=\textwidth]{step_plot/2017-205_show_res.pdf}
                \includegraphics[width=\textwidth]{step_plot/2017-206_corr.pdf}
            \end{figure}
        \end{column}
    \end{columns}
    % \vfill\null
\end{frame}

\begin{frame}[t]{4. Uncertainty Estimation}
    \begin{columns}
        \begin{column}{0.45\textwidth}
            % \begin{itemize}
              $$|\operatorname{residuals}| = |\operatorname{NDVI}^\text{`true'} - \widehat{\operatorname{NDVI}^\text{`true'}}|$$
            % \end{itemize}

            \small
            \begin{tabular}{| c |  c c c |}
                \hline
                \color{myred}{|residuals|}  & NDVI\textsuperscript{observed} & SCL & B2-B10    \\
                \color{myred}{|residuals|}  & NDVI\textsuperscript{observed} & SCL & B2-B10    \\
                \color{myred}{$\vdots$    } & $\vdots$ & $\vdots$  & $\vdots$ \\
                % \hline
            \end{tabular}\normalsize \vspace{0.5cm}

            \begin{itemize}
                \item Statistical model
                \item predict absolute residuals
                \item $weights = \frac{1}{\widehat{|residual|}}$
            \end{itemize}
        \end{column}
        \begin{column}{0.42\textwidth}
            \begin{figure}
                % \centering
                \vspace{-1.8cm}
                \includegraphics[width=\textwidth]{step_plot/2017-206_corr.pdf}
                \includegraphics[width=\textwidth]{step_plot/2017-207_uncert.pdf}
            \end{figure}
        \end{column}
    \end{columns}
    % \vfill\null
\end{frame}

\begin{frame}[t]{5. Robust Fit to Corrected NDVI}
    \begin{columns}
        \begin{column}{0.45\textwidth}
            \textbf{Reminder: Original Situation}
            \includegraphics[width=\textwidth]{step_plot/2017-201_ndvi.pdf}
        \end{column}
        \begin{column}{0.42\textwidth}
            \begin{figure}
                % \centering
                \vspace{-1.8cm}
                \includegraphics[width=\textwidth]{step_plot/2017-207_uncert.pdf}
                \includegraphics[width=\textwidth]{step_plot/2017-208_corr_itpl_rew.pdf}
            \end{figure}
        \end{column}
    \end{columns}
    % \vfill\null
\end{frame}

% \begin{frame}[t]{Overfitted?}
%     \begin{columns}
%         \begin{column}{0.45\textwidth}
%             \begin{figure}
%                 Leave current year out for training
%                 \includegraphics[width=\textwidth]{step_plot/2017-208_corr_itpl_rew.pdf}
%             \end{figure}
%         \end{column}
%         \begin{column}{0.45\textwidth}
%             \begin{figure}
%                 % \centering
%                 Use all years for training
%                 \includegraphics[width=\textwidth]{step_plot/2017-208_corr_itpl_rew.pdf}
%             \end{figure}
%         \end{column}
%     \end{columns}
%     % \vfill\null
% \end{frame}
